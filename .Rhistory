labs(x = 'Type of source', y = 'Number of facilities')
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities') +
scale_fill_manual(values = bar_colors)
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities') +
scale_fill_manual(values = n_sources$bar_colors)
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities') +
scale_fill_manual(values = n_sources$bar_colors)
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity', fill = my_own_colors) +
labs(x = 'Type of source', y = 'Number of facilities') +
scale_fill_manual(values = n_sources$bar_colors)
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity', fill = 'my_own_colors') +
labs(x = 'Type of source', y = 'Number of facilities')
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities') +
scale_color_manual(values = n_sources$bar_colors)
class(n_sources$ll_source)
n_sources <- facilities %>%
group_by(ll_source) %>%
count() %>%
arrange(desc(n)) %>%
as.factor(ll_source)
n_sources <- facilities %>%
group_by(ll_source) %>%
count() %>%
arrange(desc(n))
facilities %>%
group_by(ll_source) %>%
count() %>%
arrange(desc(n))
n_sources <- facilities %>%
group_by(ll_source) %>%
count() %>%
arrange(desc(n))
n_sources
n_sources <- facilities %>%
group_by(ll_source) %>%
count() %>%
arrange(desc(n))
n_sources
#colors for plot
bar_col <-  c(rep('black', times = nrow(n_sources)))
bar_col[7] <- 'red'
bar_col
n_sources$bar_colors <- bar_col
n_sources
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = reorder(n)), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities')
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source), y = n), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities')
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Type of source', y = 'Number of facilities')
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities')
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60,000, 2000), labels = seq(0, 60,000, 2000))
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 2000), labels = seq(0, 60000, 2000))
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 2000), labels = seq(0, 60000, 4000))
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000))
library(ggthemes)
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist()
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme(axis.title.x = element_text(size = 14))
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
theme_economist()
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
data(tips, package = "reshape2")
tips
n_sources$ll_source <- as.factor(n_sources$ll_source)
n_sources
n_sources$ll_source <- forcats::fct_explicit_na(n_sources$ll_source)
n_sources
ggplot(data = n_sources) +
geom_bar(aes(x = ll_source, y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, n), y = n), stat = 'identity') +
labs(x = 'Source', y = 'Number of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
n_sources_percentage <- count(ll_sources) %>%
mutate(perc = n / nrow(ll_sources))
n_sources_percentage <- facilities %>%
count(ll_sources) %>%
mutate(perc = n / nrow(ll_sources))
facilities
n_sources_percentage <- facilities %>%
count(ll_source) %>%
mutate(perc = n / nrow(ll_source))
library(scales)
n_sources_percentage <- facilities %>%
count(ll_source) %>%
mutate(perc = n / nrow(ll_source))
facilities %>%
count(ll_source)
n_sources
n_sources$perc <- n_sources$n/sum(n_sources$n)
n_sources
n_sources$perc <- (n_sources$n/sum(n_sources$n))*100
n_sources
n_sources$perc <- round((n_sources$n/sum(n_sources$n))*100, 2)
n_sources
n_sources$percentage <- round((n_sources$n/sum(n_sources$n))*100, 2)
n_sources
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = n), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = n), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14))
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage, fill = variable), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_color_manual(values = bar_col)
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage, fill = 'variable'), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_color_manual(values = bar_col)
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable', stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_color_manual(values = bar_col)
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_color_manual(values = bar_col)
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage, fill = 'variable'), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources) +
geom_bar(aes(x = reorder(ll_source, percentage), y = percentage), stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
bar_col
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage, fill = 'variable')) +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
#colors for plot
bar_col <-  c(rep('black', times = nrow(n_sources)))
bar_col[1] <- 'red'
bar_col
n_sources$bar_colors <- bar_col
n_sources$ll_source <- forcats::fct_explicit_na(n_sources$ll_source)
n_sources$percentage <- round((n_sources$n/sum(n_sources$n))*100, 2)
n_sources
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage, fill = 'variable')) +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 0.5)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 270, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 1, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 135, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 170, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1, size = 10)) +
scale_fill_manual(values = bar_col)
ggplot(data = n_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1, size = 14)) +
scale_fill_manual(values = bar_col)
source('C:/Users/JAMESAZAM/GitRepositories/ds_ml/scripts/r-scripts/ssa_health_facilities_viz.R')
facilities %>%
count(ll_source) %>%
mutate(percentage = n / nrow(ll_source)) %>%
arrange(desc(percentage))
#data
facilities <- read_excel(path = 'data/public_health_facilities_ssa.xlsx', na = c('', 'na'))
facilities <- clean_names(facilities)
facilities$ll_source <- tolower(facilities$ll_source)
percentage_sources <- facilities %>%
count(ll_source) %>%
mutate(percentage = n / nrow(ll_source)) %>%
arrange(desc(percentage))
facilities %>%
count(ll_source)
facilities %>%
count(ll_source) %>%
mutate(percentage = n / nrow(.))
facilities %>%
count(ll_source) %>%
mutate(percentage = n / nrow(.)) %>%
arrange(desc(percentage))
facilities %>%
count(ll_source) %>%
mutate(percentage = n / sum(.)) %>%
arrange(desc(percentage))
facilities %>%
count(ll_source) %>%
mutate(percentage = n / sum(n)) %>%
arrange(desc(percentage))
facilities %>%
count(ll_source) %>%
mutate(percentage = round((n / sum(n))*100, 2)) %>%
arrange(desc(percentage))
percentage_sources <- facilities %>%
count(ll_source) %>%
mutate(percentage = round((n / sum(n))*100, 2)) %>%
arrange(desc(percentage))
#colors for plot
bar_col <-  c(rep('black', times = nrow(n_sources)))
bar_col[1] <- 'red'
bar_col
n_sources$bar_colors <- bar_col
percentage_sources <- facilities %>%
count(ll_source) %>%
mutate(percentage = round((n / sum(n))*100, 2)) %>%
arrange(desc(percentage))
#colors for plot
bar_col <-  c(rep('black', times = nrow(percentage_sources)))
bar_col[1] <- 'red'
bar_col
n_sources$bar_colors <- bar_col
#colors for plot
bar_col <-  c(rep('black', times = nrow(percentage_sources)))
bar_col[1] <- 'red'
bar_col
percentage_sources$bar_colors <- bar_col
bar_col[7] <- 'red'
bar_col
percentage_sources$bar_colors <- bar_col
#colors for plot
bar_col <-  c(rep('black', times = nrow(percentage_sources)))
bar_col[7] <- 'red'
bar_col
percentage_sources$bar_colors <- bar_col
percentage_sources$ll_source <- forcats::fct_explicit_na(n_sources$ll_source)
percentage_sources$ll_source <- forcats::fct_explicit_na(percentage_sources$ll_source)
percentage_sources$ll_source <- forcats::fct_explicit_na(percentage_sources$ll_source, na_level = 'missing')
percentage_sources
percentage_sources$bar_colors <- bar_col
percentage_sources$ll_source <- forcats::fct_explicit_na(percentage_sources$ll_source, na_level = 'missing')
percentage_sources
percentage_sources
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1, size = 14))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 135, hjust = 1, size = 14))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, hjust = 1, size = 14))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, size = 14))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
# scale_y_continuous(breaks = seq(0, 60000, 4000), labels = seq(0, 60000, 4000)) +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, vjust = 1))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, vjust = 3))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, vjust = -1))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 45, hjust = 1))
90
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1))
source('C:/Users/JAMESAZAM/GitRepositories/ds_ml/scripts/r-scripts/ssa_health_facilities_viz.R')
library(readxl)
library(dplyr)
library(ggplot2)
library(janitor)
library(ggthemes)
library(scales)
#data
facilities <- read_excel(path = 'data/public_health_facilities_ssa.xlsx', na = c('', 'na'))
facilities <- clean_names(facilities)
#descriptives
summary(facilities)
View(head(facilities, n = 20))
facilities$ll_source <- tolower(facilities$ll_source)
percentage_sources <- facilities %>%
count(ll_source) %>%
mutate(percentage = round((n / sum(n))*100, 2)) %>%
arrange(desc(percentage))
#colors for plot
bar_col <-  c(rep('black', times = nrow(percentage_sources)))
bar_col[7] <- 'red'
bar_col
percentage_sources$bar_colors <- bar_col
percentage_sources$ll_source <- forcats::fct_explicit_na(percentage_sources$ll_source)
percentage_sources
ggplot(data = percentage_sources, aes(x = reorder(ll_source, percentage), y = percentage), fill = 'variable') +
geom_bar(stat = 'identity') +
labs(x = 'Source', y = 'Percent of facilities') +
theme_economist() +
theme(axis.title.x = element_text(size = 14), axis.title.y = element_text(size = 14), axis.text.x = element_text(angle = 90, hjust = 1))
